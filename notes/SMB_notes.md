# Port 445 SMB
Technically, Port 139 is referred to as ‘NBT over IP’, whereas Port 445 is identified as ‘SMB over IP’. The acronym **SMB** stands for ‘**Server Message Blocks**’, which is also modernly known as the **Common Internet File System (CIFS)**. As an application-layer network protocol, SMB/CIFS is primarily utilized to enable shared access to files, printers, serial ports, and facilitate various forms of communication between nodes on a network.

For example, in the context of Windows, it is highlighted that SMB can operate directly over TCP/IP, eliminating the necessity for NetBIOS over TCP/IP, through the utilization of port 445. Conversely, on different systems, the employment of port 139 is observed, indicating that SMB is being executed in conjunction with NetBIOS over TCP/IP.

`445/tcp   open  microsoft-ds  Windows 7 Professional 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)`

# Port 139 NetBIOS

The **Network Basic Input Output System** (NetBIOS) is a software protocol designed to enable applications, PCs, and Desktops within a local area network (LAN) to interact with network hardware and facilitate the transmission of data across the network. The identification and location of software applications operating on a NetBIOS network are achieved through their NetBIOS names, which can be up to 16 characters in length and are often distinct from the computer name. A NetBIOS session between two applications is initiated when one application (acting as the client) issues a command to "call" another application (acting as the server) utilizing TCP Port 139.

`139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn`

# SMB

The Server Message Block (SMB) protocol, operating in a client-server model, is designed for regulating access to files, directories, and other network resources like printers and routers. Primarily utilized within the Windows operating system series, SMB ensures backward compatibility, allowing devices with newer versions of Microsoft's operating system to seamlessly interact with those running older versions. Additionally, the Samba project offers a free software solution, enabling SMB's implementation on Linux and Unix systems, thereby facilitating cross-platform communication through SMB.

Shares, representing arbitrary parts of the local file system, can be provided by an SMB server, making the hierarchy visible to a client partly independent from the server's actual structure. The Access Control Lists (ACLs), which define access rights, allow for fine-grained control over user permissions, including attributes like 
`execute`,`read`, and `full access`. These permissions can be assigned to individual users or groups, based on the shares, and are distinct from the local permissions set on the server.

To list a target's share list we use `smbclient -L <target_ip>`. with this it is possible to see the complete list of shared disrectory. Notice that the ones with $ sign are created by administrator and so sometimes could be vulnerable. 

## Exacmple from hack the box DANCING

On the following we see a system that has a total of 4 directories as shown in picture:

![image](https://github.com/user-attachments/assets/c706d36b-a869-435c-a408-a02553351f5e)

After dowing whis it is possible to use `smbclient \\\\<target_ip>\\target_dir` to try accessing those directories. We see in fact that WorkShares does not have any password:

![image](https://github.com/user-attachments/assets/060f5bae-f9b6-476c-98e9-b15a4cf627bb)

And therefore we investigate on some commands that are available such as GET to download important files. 

# IPC$ Share

Access to the IPC$ share can be obtained through an anonymous null session allowing interaction with exposed services. The ulitity `enum4linux` is useful for the purpose, it can give you:

- Informations on the operative system
- Details on the parent domain
- A compilation of local users and groups
- Informations on available SMB shares
- The system security policy

This tool provide a comprehensive view of target system's SMB environment that is essential for identifying potential vulnerabilities. 

`enum4linux -a target_ip` is an example of command to be used for enumerating target_ip. 





